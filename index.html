<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–ª–æ–≤–∏–Ω–∫–∏ ‚Äî –°–ª–∞–¥–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫ –ª—é–±–∏–º—ã–º</title>
  <meta name="description" content="–ü–æ–ª–æ–≤–∏–Ω–∫–∏ –ö–ú–í ‚Äî –¥–æ–º–∞—à–Ω—è—è –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è. –û—Ä–µ—à–∫–∏ —Å –≤–∞—Ä—ë–Ω–æ–π —Å–≥—É—â—ë–Ω–∫–æ–π. –ò–¥–µ–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞ 14 —Ñ–µ–≤—Ä–∞–ª—è!">
  <meta name="robots" content="index,follow">
  <link rel="canonical" href="https://polovinkikmv.ru/">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <meta name="theme-color" content="#fff0f5">
  <meta property="og:type" content="website">
  <meta property="og:title" content="–ü–æ–ª–æ–≤–∏–Ω–∫–∏ ‚Äî –î–µ–Ω—å –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞">
  <meta property="og:description" content="–û—Ä–µ—à–∫–∏ —Å –≤–∞—Ä—ë–Ω–æ–π —Å–≥—É—â—ë–Ω–∫–æ–π. –°–ª–∞–¥–∫–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –≤ –ª—é–±–≤–∏.">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Cormorant+Garamond:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      /* –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–ª–∏—Ç—Ä–∞ */
      --bg: #fff0f5; /* –õ–∞–≤–∞–Ω–¥–æ–≤—ã–π —Ä—É–º—è–Ω–µ—Ü */
      --fg: #4a2c2a; /* –¢–µ–º–Ω—ã–π —à–æ–∫–æ–ª–∞–¥ */
      --muted: #8e5e5e;
      
      --val-red: #d32f2f; /* –°—Ç—Ä–∞—Å—Ç–Ω—ã–π –∫—Ä–∞—Å–Ω—ã–π */
      --val-pink: #e91e63; /* –Ø—Ä–∫–∏–π —Ä–æ–∑–æ–≤—ã–π */
      --val-light: #ffc1e3;
      
      --gold: #d4af37;
      
      --shadow: 0 12px 40px rgba(74, 44, 42, 0.12);
      --radius: 20px;
      
      --h1: clamp(32px, 5vw, 56px);
      --h2: clamp(20px, 2.5vw, 26px);
      --p: clamp(17px, 1.8vw, 19px);
      
      --container: min(1120px, 92vw);
    }

    * { box-sizing: border-box; }
    html, body { scroll-behavior: smooth; }

    body {
      margin: 0;
      font-family: 'Cormorant Garamond', serif;
      background: var(--bg);
      color: var(--fg);
      line-height: 1.6;
      text-align: center;
      overflow-x: hidden;
      position: relative;
    }

    /* –§–æ–Ω–æ–≤—ã–π —à—É–º –¥–ª—è —Ç–µ–∫—Å—Ç—É—Ä—ã */
    body::before {
      content: "";
      position: fixed; inset: 0;
      pointer-events: none;
      z-index: -1;
      opacity: .15;
      background-image: url("data:image/svg+xml,%3Csvg width='200' height='200' viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='1'/%3E%3C/svg%3E");
    }

    /* –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ */
    h1 {
      font-size: var(--h1);
      margin: 0 0 .3em;
      font-weight: 700;
      font-family: 'Playfair Display', serif;
      color: var(--val-red);
      text-shadow: 0 2px 0 rgba(255,255,255,.5);
    }

    h2 {
      font-size: var(--h2);
      font-weight: 500;
      margin: 0 0 1.2em;
      color: var(--val-pink);
      letter-spacing: .5px;
    }

    p { font-size: var(--p); margin: 0 auto 1em; max-width: 68ch; }

    .container { width: var(--container); margin-inline: auto; position: relative; z-index: 2; }
    section { padding: clamp(40px, 6vw, 80px) 0; }

    /* ====== –ö–ù–û–ü–ö–ò ====== */
    .btn {
      display: inline-block;
      padding: 1em 2.4em;
      margin-top: 1.2em;
      background: linear-gradient(135deg, var(--val-pink), var(--val-red));
      color: #fff;
      font-size: clamp(15px, 1.5vw, 18px);
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      letter-spacing: .5px;
      border: 2px solid #fff;
      box-shadow: 0 4px 15px rgba(233, 30, 99, 0.4);
      transition: all .3s cubic-bezier(.25,.8,.25,1);
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }
    
    .btn::after {
      content: "";
      position: absolute; top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent);
      transition: .5s;
    }
    
    .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(233, 30, 99, 0.6); }
    .btn:hover::after { left: 100%; }
    .btn:disabled { opacity: .7; cursor: not-allowed; transform: none; }

    .btn-outline {
      background: transparent;
      color: var(--val-pink);
      border: 2px solid var(--val-pink);
      box-shadow: none;
      padding: .85em 1.8em;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      cursor: pointer;
      display: inline-block;
    }
    .btn-outline:hover { background: var(--val-pink); color: #fff; }

    /* ====== HERO ====== */
    .hero { margin-top: 50px; }
    .hero-grid { display: grid; gap: 40px; align-items: center; }
    @media (min-width: 900px) { .hero-grid { grid-template-columns: 1fr 1fr; text-align: left; } }

    .logo {
      width: clamp(200px, 35vw, 320px);
      height: auto;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,0.1));
      border-radius: 50%;
      border: 4px solid #fff;
    }

    /* ====== –ö–ê–†–¢–û–ß–ö–ò / –§–û–†–ú–ê ====== */
    .card, .reviews-card {
      background: #fff;
      border-radius: var(--radius);
      padding: clamp(24px, 4vw, 40px);
      border: 1px solid rgba(0,0,0,0.05);
      box-shadow: var(--shadow);
      text-align: left;
      position: relative;
      overflow: hidden;
    }

    /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ–ª–æ—Å–∫–∞ —Å–≤–µ—Ä—Ö—É (—Ä–æ–∑–æ–≤–∞—è/–∫—Ä–∞—Å–Ω–∞—è) */
    .card::before, .reviews-card::before {
      content: "";
      position: absolute; top: 0; left: 0; right: 0; height: 6px;
      background: repeating-linear-gradient(45deg, var(--val-red), var(--val-red) 10px, #fff 10px, #fff 20px);
    }

    .grid { display: grid; gap: 20px; }
    @media (min-width: 700px) { .grid { grid-template-columns: 1fr 1fr; } }
    .row { display: flex; flex-direction: column; }

    label { display: block; font-size: .95rem; color: var(--muted); margin-bottom: 8px; font-weight: 600; }
    input, select, textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.1);
      background: #fdfdfd;
      font-family: inherit;
      font-size: 1rem;
      color: var(--fg);
      transition: all .2s;
      outline: none;
    }
    input:focus, select:focus, textarea:focus {
      border-color: rgba(233, 30, 99, 0.45);
      box-shadow: 0 0 0 4px rgba(233, 30, 99, 0.10);
    }

    .summary {
      background: #fff5f8;
      border: 2px dashed #f8bbd0;
      padding: 16px;
      border-radius: 12px;
      margin-top: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    .summary strong { color: var(--val-red); font-size: 1.2em; }
    
    .muted { color: var(--muted); }
    .actions { display: flex; justify-content: center; margin-top: 18px; }
    .note { margin-top: 12px; color: var(--val-pink); text-align: center; }

    /* ====== –ü–†–û–ß–ï–ï ====== */
    .divider { display: flex; align-items: center; justify-content: center; margin: 40px auto; gap: 10px; opacity: .8; }
    .divider::before, .divider::after { content: ""; height: 1px; width: 60px; background: var(--gold); }
    .divider span { font-size: 24px; color: var(--val-red); }

    .fade-in { opacity: 0; transform: translateY(30px); transition: all .8s ease-out; }
    .fade-in.visible { opacity: 1; transform: translateY(0); }

    footer { background: var(--fg); color: #efe3d0; padding: 40px 0; margin-top: 60px; }
    .footer-actions { margin-top: 14px; display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; }

    dialog { border: none; border-radius: 20px; padding: 0; width: min(600px, 94vw); box-shadow: 0 25px 50px rgba(0,0,0,0.25); }
    dialog::backdrop { background: rgba(74, 44, 42, 0.4); backdrop-filter: blur(2px); }
    .modal-body { padding: 30px; }
    .modal-close { border: 0; background: rgba(0,0,0,0.06); color: var(--fg); border-radius: 12px; padding: 8px 12px; cursor: pointer; font: inherit; }
    .modal-close:hover { background: rgba(0,0,0,0.10); }

    .stars { color: var(--gold); }
    .reviews-strip { background: #fffbf6; border: 1px solid #efe3d0; border-radius: 16px; padding: 16px; margin-top: 20px; }
    .strip-track { display: grid; grid-auto-flow: column; grid-auto-columns: min(300px, 80%); gap: 16px; overflow-x: auto; padding-bottom: 10px; scroll-snap-type: x mandatory; }
    .review-mini { background: #fff; padding: 16px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.03); scroll-snap-align: start; cursor: pointer; display: flex; flex-direction: column; gap: 6px; text-align: left; }

    /* CANVAS –î–õ–Ø –°–ï–†–î–ï–ß–ï–ö */
    #hearts-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
  </style>
</head>
<body>

  <canvas id="hearts-canvas"></canvas>

  <section class="hero fade-in">
    <div class="container hero-grid">
      <div class="logo-wrap" style="text-align:center;">
        <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø –ü–æ–ª–æ–≤–∏–Ω–∫–∏" class="logo" loading="lazy">
      </div>
      <div>
        <h1 class="val-title">–ü–æ–ª–æ–≤–∏–Ω–∫–∏</h1>
        <h2>–î–æ–º–∞—à–Ω—è—è –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è</h2>
        <p><em>–û—Ä–µ—à–∫–∏ ‚Äî —Å–ª–∞–¥–∫–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –≤ –ª—é–±–≤–∏.</em></p>
        <p>–•—Ä—É—Å—Ç—è—â–∞—è —Å–∫–æ—Ä–ª—É–ø–∫–∞, –Ω–µ–∂–Ω–æ–µ —Ç–µ—Å—Ç–æ –∏ –º–Ω–æ–≥–æ –≤–∞—Ä—ë–Ω–æ–π —Å–≥—É—â—ë–Ω–∫–∏ —Å –≥—Ä–µ—Ü–∫–∏–º –æ—Ä–µ—Ö–æ–º. –ò–¥–µ–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è –≤–∞—à–µ–π –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–∫–∏ –Ω–∞ 14 —Ñ–µ–≤—Ä–∞–ª—è.</p>
        
        <!-- –ö–ù–û–ü–ö–ê ‚Äú–°–î–ï–õ–ê–¢–¨ –ó–ê–ö–ê–ó‚Äù -->
        <a href="#order" class="btn">–ó–∞–∫–∞–∑–∞—Ç—å –∫ 14 —Ñ–µ–≤—Ä–∞–ª—è</a>
      </div>
    </div>
  </section>

  <div class="divider"><span>‚ù§Ô∏è</span></div>

  <section class="fade-in">
    <div class="container">
      <p style="font-size: 1.2rem; max-width: 700px; margin: auto;">
        –ú—ã –≥–æ—Ç–æ–≤–∏–º —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ª–∞–∫–æ–º—Å—Ç–≤–æ, –¥–æ–≤–µ–¥—ë–Ω–Ω–æ–µ –¥–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞.
        –í –∫–∞–∂–¥–æ–º –æ—Ä–µ—à–∫–µ ‚Äî —Ç–µ–ø–ª–æ –Ω–∞—à–∏—Ö —Ä—É–∫ –∏ —á–∞—Å—Ç–∏—á–∫–∞ –Ω–∞—à–µ–π –ª—é–±–≤–∏.
      </p>
    </div>
  </section>

  <div class="divider"><span>üåπ</span></div>

  <!-- ======= –§–û–†–ú–ê –ó–ê–ö–ê–ó–ê ======= -->
  <section id="order" class="fade-in" aria-labelledby="order-title">
    <div class="container">
      <h1 id="order-title" style="margin-bottom:.2em; text-align:center;">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
      <p class="muted" style="margin-bottom:1.2em; text-align:center;">
        –¢–æ–≤–∞—Ä: <strong>–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è –∫–æ—Ä–æ–±–æ—á–∫–∞ (6 —à—Ç)</strong> ‚Äî <strong>250 ‚ÇΩ</strong>
      </p>

      <div class="card" role="region" aria-label="–§–æ—Ä–º–∞ –∑–∞–∫–∞–∑–∞">
        <form id="order-form" action="https://formspree.io/f/xgvleerr" method="POST" autocomplete="on" novalidate>
          <div class="grid">
            <div class="row">
              <label for="name">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è*</label>
              <input id="name" name="name" required autocomplete="name">
            </div>
            <div class="row">
              <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏*</label>
              <input id="phone" name="phone" inputmode="tel" required
                     placeholder="+7 999 123-45-67"
                     pattern="^[\d\+\-\s\(\)]{7,}$"
                     autocomplete="tel">
            </div>
            <div class="row">
              <label for="social">–°–æ—Ü—Å–µ—Ç–∏ (WhatsApp/Telegram)</label>
              <input id="social" name="social" placeholder="+7 999 123-45-67 –∏–ª–∏ @username">
            </div>
            <div class="row">
              <label for="qty">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤*</label>
              <select id="qty" name="qty" required>
                <option value="1" selected>1 –∫–æ—Ä–æ–±–∫–∞ ‚Äî 6 —à—Ç</option>
                <option value="2">2 –∫–æ—Ä–æ–±–∫–∏ ‚Äî 12 —à—Ç</option>
                <option value="3">3 –∫–æ—Ä–æ–±–∫–∏ ‚Äî 18 —à—Ç</option>
                <option value="4">4 –∫–æ—Ä–æ–±–∫–∏ ‚Äî 24 —à—Ç</option>
                <option value="5">5 –∫–æ—Ä–æ–±–æ–∫ ‚Äî 30 —à—Ç</option>
              </select>
            </div>
            <div class="row">
              <label for="date">–î–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è (13-14 —Ñ–µ–≤)*</label>
              <input type="date" id="date" name="date" required>
            </div>
            <div class="row">
              <label for="time">–í—Ä–µ–º—è (–æ—Ä–∏–µ–Ω—Ç–∏—Ä)</label>
              <input type="time" id="time" name="time">
            </div>
            <div class="row" style="grid-column: 1 / -1;">
              <label for="method">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è (–∑–∞–∫–∞–∑ < 15 —É–ø–∞–∫–æ–≤–æ–∫ - –¥–æ—Å—Ç–∞–≤–∫–∞ –ø–ª–∞—Ç–Ω–∞—è)</label>
              <select id="method" name="method">
                <option value="pickup" selected>–°–∞–º–æ–≤—ã–≤–æ–∑</option>
                <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞</option>
              </select>
            </div>
            <div class="row" id="address-row" style="display:none; grid-column: 1 / -1;">
              <label for="address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
              <input id="address" name="address" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –ø–æ–¥—ä–µ–∑–¥" autocomplete="street-address">
            </div>
            <div class="row" style="grid-column: 1 / -1;">
              <label for="comment">–í–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞ / –ü–æ–∂–µ–ª–∞–Ω–∏–µ</label>
              <textarea id="comment" name="comment" rows="3" placeholder="–ù—É–∂–Ω–∞ –ª–∏ –æ—Ç–∫—Ä—ã—Ç–∫–∞-–≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞? –ß—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å?"></textarea>
            </div>
          </div>

          <div class="summary" aria-live="polite">
            <span>–ò—Ç–æ–≥–æ: <strong id="total-text">250 ‚ÇΩ</strong></span>
            <span class="muted">250 ‚ÇΩ √ó <span id="qty-text">1</span> –∫–æ—Ä–æ–±.</span>
          </div>

          <div class="actions">
            <button id="submit-btn" type="submit" class="btn">–ü–æ–¥–∞—Ä–∏—Ç—å –ª—é–±–æ–≤—å</button>
          </div>
          <p id="form-status" class="note" style="display:none;"></p>
        </form>
      </div>
    </div>
  </section>

  <div class="divider"><span>üíå</span></div>

  <section id="reviews-section" class="fade-in">
    <div class="container">
      <h1 style="text-align:center;">–û—Ç–∑—ã–≤—ã –≤–ª—é–±–ª—ë–Ω–Ω—ã—Ö</h1>
      <div class="reviews-card">
        <form id="reviewForm" style="display:grid; gap:10px;">
          <input type="text" name="name" placeholder="–í–∞—à–µ –∏–º—è" required>
          <textarea name="text" placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏..." rows="3" required></textarea>
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <select name="rating" style="width:auto;">
              <option value="5">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è (5)</option>
              <option value="4">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è (4)</option>
            </select>
            <button type="submit" class="btn" style="margin:0; padding: 0.8em 1.5em; font-size: 0.9rem;">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
          </div>
          <small id="reviewStatus" style="color:var(--muted)"></small>
        </form>

        <div class="reviews-strip">
          <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
            <strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã</strong>
            <button id="openAllBtn" type="button" class="btn-outline" style="padding:4px 10px; font-size:12px; border-radius:12px;">–í—Å–µ –æ—Ç–∑—ã–≤—ã</button>
          </div>
          <div id="reviewsTrack" class="strip-track">
            <div class="review-mini"><div class="mini-text">–ó–∞–≥—Ä—É–∂–∞–µ–º —Ç—ë–ø–ª—ã–µ —Å–ª–æ–≤–∞...</div></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <p style="font-size:1.4rem; font-family:'Playfair Display', serif;">–ü–æ–ª–æ–≤–∏–Ω–∫–∏</p>
      <p>–° –ª—é–±–æ–≤—å—é, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å!</p>
      <div class="footer-actions">
        <a class="btn-outline" href="https://www.instagram.com/polovinki_kmv?igsh=Nm4wN3A0YnRlZDMy" target="_blank" rel="noopener">–ú—ã –≤ Instagram</a>
      </div>
      <p style="font-size:0.8rem; opacity:0.6; margin-top:14px;">&copy; 2025 –î–æ–º–∞—à–Ω—è—è –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è –ö–ú–í</p>
    </div>
  </footer>

  <dialog id="reviewModal">
    <div class="modal-body">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <h3 id="modalName" style="margin:0">–ò–º—è</h3>
        <button id="modalClose" class="modal-close">‚úï</button>
      </div>
      <div id="modalStars" class="stars"></div>
      <p id="modalText" style="margin-top:10px; white-space: pre-wrap;"></p>
      <small id="modalDate" style="color:var(--muted)"></small>
    </div>
  </dialog>

  <dialog id="allReviewsModal">
    <div class="modal-body" style="max-height:80vh; overflow-y:auto;">
      <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
        <h3 style="margin:0">–í—Å–µ –æ—Ç–∑—ã–≤—ã</h3>
        <button id="allClose" class="modal-close">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
      <div id="allReviewsContainer"></div>
    </div>
  </dialog>

  <script>
    // –ê–ù–ò–ú–ê–¶–ò–Ø –ü–û–Ø–í–õ–ï–ù–ò–Ø
    const faders = document.querySelectorAll('.fade-in');
    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => {
        if (!entry.isIntersecting) return;
        entry.target.classList.add('visible');
        obs.unobserve(entry.target);
      });
    }, { threshold: 0.1 });
    faders.forEach(f => observer.observe(f));

    // ===== –õ–æ–≥–∏–∫–∞ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞ =====
    const PRICE_PER_BOX = 250;
    const qtyEl = document.getElementById('qty');
    const totalTextEl = document.getElementById('total-text');
    const qtyTextEl = document.getElementById('qty-text');
    const methodEl = document.getElementById('method');
    const addressRow = document.getElementById('address-row');
    const form = document.getElementById('order-form');
    const statusEl = document.getElementById('form-status');
    const submitBtn = document.getElementById('submit-btn');

    // === –ü–∞—Ä–∞–º–µ—Ç—Ä—ã Telegram —á–µ—Ä–µ–∑ Google Apps Script (–¢–æ—Ç –∂–µ endpoint, —á—Ç–æ –∏ —Ä–∞–Ω—å—à–µ) ===
    const TG_ENDPOINT = 'https://script.google.com/macros/s/AKfycbyHLwMieXZw_2eAf-A7w_75gO4nTuzbAOGIuZgJdDHdUsIdUlhLtSc9tCZ2zUI15ppZpw/exec';
    const TG_SECRET = 'PolovinkiKmV25';

    function formatRUB(v){
      try { return new Intl.NumberFormat('ru-RU',{style:'currency',currency:'RUB',maximumFractionDigits:0}).format(v); }
      catch { return Math.round(v)+' ‚ÇΩ'; }
    }

    function updateSummary(){
      const qty = parseInt(qtyEl.value,10) || 1;
      const total = qty * PRICE_PER_BOX;
      totalTextEl.textContent = formatRUB(total);
      qtyTextEl.textContent = String(qty);
    }

    qtyEl?.addEventListener('change', updateSummary);
    updateSummary();

    methodEl?.addEventListener('change', () => {
      addressRow.style.display = (methodEl.value === 'delivery') ? '' : 'none';
    });

    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const social = document.getElementById('social').value.trim();
      const qty = parseInt(qtyEl.value, 10) || 1;
      const date = document.getElementById('date').value;
      const time = document.getElementById('time').value;
      const method = methodEl.value;
      const address = (document.getElementById('address').value || '').trim();
      const comment = (document.getElementById('comment').value || '').trim();

      if(!name || !phone || !date){
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –¥–∞—Ç—É –ø–æ–ª—É—á–µ–Ω–∏—è.');
        return;
      }
      if(method === 'delivery' && !address){
        alert('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏.');
        return;
      }

      const total = qty * PRICE_PER_BOX;
      const payload = {
        product:'–ö–æ—Ä–æ–±–æ—á–∫–∞ –æ—Ä–µ—à–∫–æ–≤ (6 —à—Ç)',
        unit_price: PRICE_PER_BOX + ' ‚ÇΩ',
        quantity: qty,
        total: total + ' ‚ÇΩ',
        date, time,
        method: method === 'pickup' ? '–°–∞–º–æ–≤—ã–≤–æ–∑' : '–î–æ—Å—Ç–∞–≤–∫–∞',
        address: method === 'delivery' ? address : '',
        name, phone, social, comment
      };

      submitBtn.disabled = true;
      submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';
      statusEl.style.display = 'block';
      statusEl.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑...';

      try{
        // 1) Formspree
        const resp = await fetch('https://formspree.io/f/xgvleerr',{
          method:'POST',
          headers:{'Accept':'application/json','Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });

        // 2) Relay Telegram
        const tgPayload = { ...payload, secret: TG_SECRET, origin: location.origin };
        fetch(TG_ENDPOINT, {
          method:'POST',
          headers:{'Content-Type':'text/plain;charset=utf-8'},
          body: JSON.stringify(tgPayload)
        }).catch(err => console.error('TG relay failed:', err));

        if(resp.ok){
          form.reset();
          updateSummary();
          addressRow.style.display = 'none';
          statusEl.innerHTML = '–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑! –ú—ã —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.';
        } else {
          statusEl.textContent = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
        }
      }catch(e){
        console.error(e);
        statusEl.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.';
      }finally{
        submitBtn.disabled = false;
        submitBtn.textContent = '–ü–æ–¥–∞—Ä–∏—Ç—å –ª—é–±–æ–≤—å';
      }
    });

    // –û–¢–ó–´–í–´ (–õ–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞)
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwAaB9udbz_EHUWPqvSca8Ve3p_D_8thmGDv1MZOLQzJ09vStTb6A89Gizp9zEePdMj/exec';
    function stars(n){ return '‚òÖ'.repeat(n) + '‚òÜ'.repeat(5-n); }

    async function loadReviews(){
      const track = document.getElementById('reviewsTrack');
      try{
        const res = await fetch(SCRIPT_URL + '?limit=10');
        const json = await res.json();
        const items = (json.items || []).reverse();
        track.innerHTML = items.map((r,i)=>`
          <div class="review-mini" onclick="showReview(${i})">
            <div style="display:flex;justify-content:space-between;gap:10px;align-items:center;">
              <strong>${r.name}</strong>
              <span class="stars">${stars(r.rating)}</span>
            </div>
            <div style="font-size:0.9rem;overflow:hidden;">${r.text}</div>
          </div>`).join('');
        window.revs = items;
      }catch(e){
        track.innerHTML = '–û—Ç–∑—ã–≤—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...';
      }
    }

    window.showReview = (i)=>{
      const r = window.revs[i];
      document.getElementById('modalName').textContent = r.name;
      document.getElementById('modalStars').textContent = stars(r.rating);
      document.getElementById('modalText').textContent = r.text;
      document.getElementById('reviewModal').showModal();
    };
    document.getElementById('modalClose').onclick = ()=>document.getElementById('reviewModal').close();
    loadReviews();

    // ====== –ê–ù–ò–ú–ê–¶–ò–Ø –°–ï–†–î–ï–ß–ï–ö (–≤–º–µ—Å—Ç–æ —Å–Ω–µ–≥–∞) ======
    (function(){
      const cvs = document.getElementById('hearts-canvas');
      const ctx = cvs.getContext('2d');
      let w, h, hearts = [];

      function resize(){
        w = cvs.width = window.innerWidth;
        h = cvs.height = window.innerHeight;
      }
      window.addEventListener('resize', resize);
      resize();

      // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ —Å–µ—Ä–¥–µ—á–µ–∫
      const symbols = ['‚ù§', '‚ô•', '‚ô°'];
      // –¶–≤–µ—Ç–∞: –æ—Ç –Ω–µ–∂–Ω–æ-—Ä–æ–∑–æ–≤–æ–≥–æ –¥–æ —è—Ä–∫–æ-–∫—Ä–∞—Å–Ω–æ–≥–æ
      const colors = ['#e91e63', '#ffc1e3', '#d32f2f', '#ff80ab', '#fce4ec'];

      for(let i=0; i<60; i++){
        hearts.push({
          x: Math.random() * w,
          y: Math.random() * h,
          s: Math.random() * 10 + 10, // –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (10-20px)
          d: Math.random() * 2 + 1,   // –°–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
          char: symbols[Math.floor(Math.random() * symbols.length)],
          color: colors[Math.floor(Math.random() * colors.length)],
          swing: Math.random() * 0.1, // –ê–º–ø–ª–∏—Ç—É–¥–∞ –ø–æ–∫–∞—á–∏–≤–∞–Ω–∏—è
          offset: Math.random() * Math.PI * 2 // –§–∞–∑–∞ –ø–æ–∫–∞—á–∏–≤–∞–Ω–∏—è
        });
      }

      function draw(){
        ctx.clearRect(0, 0, w, h);
        
        for(const hrt of hearts){
          ctx.font = hrt.s + "px serif";
          ctx.fillStyle = hrt.color;
          ctx.fillText(hrt.char, hrt.x, hrt.y);
          
          // –î–≤–∏–∂–µ–Ω–∏–µ –≤–Ω–∏–∑
          hrt.y += hrt.d;
          // –õ–µ–≥–∫–æ–µ –ø–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ
          hrt.x += Math.sin(hrt.y * 0.01 + hrt.offset) * 0.5;

          // –ï—Å–ª–∏ —É–ª–µ—Ç–µ–ª–æ –≤–Ω–∏–∑ - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–≤–µ—Ä—Ö—É
          if(hrt.y > h){
            hrt.y = -20;
            hrt.x = Math.random() * w;
          }
        }
        requestAnimationFrame(draw);
      }
      draw();
    })();
  </script>
</body>
</html>
