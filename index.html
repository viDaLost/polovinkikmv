<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–ª–æ–≤–∏–Ω–∫–∏</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Cormorant+Garamond:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6f1eb;
      --fg:#3e2c23;
      --muted:#6b5646;
      --accent:#d8b899;
      --accent-2:#c49f7a;
      --panel:#fff9f3;
      --footer:#ede2d7;
      --ring:rgba(212, 175, 150, .45);
    }

    * { box-sizing: border-box; }
    html, body { scroll-behavior: smooth; }

    body {
      margin: 0;
      font-family: 'Cormorant Garamond', serif;
      background-color: var(--bg);
      color: var(--fg);
      line-height: 1.6;
      text-align: center;
      overflow-x: hidden;
    }

    h1 {
      font-size: 2.8rem;
      margin-bottom: 0.3em;
      font-weight: 600;
      font-family: 'Playfair Display', serif;
    }

    h2 {
      font-size: 1.3rem;
      font-weight: 400;
      margin-bottom: 1.5em;
      color: var(--muted);
    }

    p {
      max-width: 650px;
      margin: 0 auto 1em;
      font-size: 1.1rem;
    }

    section {
      padding: 3em 1.5em;
    }

    .logo {
      max-width: 800px;
      height: auto;
      margin-bottom: 1em;
    }

    @media (max-width: 800px) and (orientation: portrait) { .logo { max-width: 220px; } }
    @media (max-width: 1024px) and (orientation: landscape) { .logo { max-width: 220px; } }
    @media (min-width: 1024px) { .logo { max-width: 220px; } }

    .btn {
      display: inline-block;
      padding: 0.9em 2em;
      margin-top: 1.0em;
      background-color: var(--accent);
      color: white;
      font-size: 1rem;
      border-radius: 30px;
      text-decoration: none;
      font-weight: 500;
      transition: background 0.3s ease, transform .1s ease;
    }
    .btn:hover { background-color: var(--accent-2); }
    .btn:active { transform: translateY(1px); }

    .btn-outline {
      background: transparent;
      color: var(--fg);
      border: 1px solid var(--accent);
    }
    .btn-outline:hover { background: var(--panel); }

    footer {
      padding: 2em 1em;
      background-color: var(--footer);
      font-size: 0.9rem;
      color: #5a4a3a;
    }
    footer p { margin: 0.3em 0; }

    /* –≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
    .divider {
      width: 60px;
      height: 2px;
      margin: 40px auto;
      background-color: var(--accent);
      border-radius: 1px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.8s ease-out;
    }
    .divider.visible { opacity: 1; transform: translateY(0); }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π */
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.8s ease-out;
    }
    .fade-in.visible { opacity: 1; transform: translateY(0); }

    /* ======= –§–û–†–ú–ê –ó–ê–ö–ê–ó–ê ======= */
    .card {
      max-width: 760px;
      margin: 0 auto;
      background: var(--panel);
      border-radius: 18px;
      padding: 1.25em;
      box-shadow: 0 10px 30px rgba(62,44,35,.08);
      text-align: left;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width:720px){ .grid { grid-template-columns: 1fr; } }

    label {
      display: block;
      font-size: 0.95rem;
      color: var(--muted);
      margin-bottom: 6px;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.06);
      background: #fff;
      font-size: 1rem;
      font-family: inherit;
      outline: none;
      transition: box-shadow .2s ease, border-color .2s ease;
    }
    input:focus, select:focus, textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--ring);
    }

    .row { margin-bottom: 12px; }

    .muted {
      color: var(--muted);
      font-size: .95rem;
    }

    .summary {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #fff;
      border: 1px dashed rgba(0,0,0,.12);
      padding: 14px 16px;
      border-radius: 12px;
      margin-top: 8px;
      font-size: 1.05rem;
    }

    .actions {
      display: flex; gap: 12px; flex-wrap: wrap; margin-top: 12px;
    }

    .note {
      font-size: .95rem;
      color: var(--muted);
      margin-top: 8px;
    }
  </style>
</head>
<body>

  <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
  <section class="fade-in">
    <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø –ü–æ–ª–æ–≤–∏–Ω–∫–∏" class="logo">
    <h1>–ü–æ–ª–æ–≤–∏–Ω–∫–∏</h1>
    <h2>–î–æ–º–∞—à–Ω—è—è –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è</h2>
    <p><em>–û—Ä–µ—à–∫–∏ ‚Äî –¥–µ—Å–µ—Ä—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–∫—É—Å –∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è</em></p>
    <p>–ù–µ–∂–Ω–æ–µ —Ç–µ—Å—Ç–æ, –∑–æ–ª–æ—Ç–∏—Å—Ç–∞—è –≤—ã–ø–µ—á–∫–∞ –∏ —Ç—è–≥—É—á–∞—è –Ω–∞—á–∏–Ω–∫–∞ –∏–∑ –≤–∞—Ä–µ–Ω–æ–π —Å–≥—É—â—ë–Ω–∫–∏, —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≥—Ä–µ—Ü–∫–∏—Ö –æ—Ä–µ—Ö–æ–≤.
    –ö–∞–∂–¥—ã–π –æ—Ä–µ—à–µ–∫ ‚Äî —ç—Ç–æ –º–∞–ª–µ–Ω—å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ä–∞–¥–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—á–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–æ–∏—Ö.</p>

    <a href="#order" class="btn" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞">–°–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</a>
  </section>

  <div class="divider"></div>

  <!-- –û–ø–∏—Å–∞–Ω–∏–µ –¥–µ—Å–µ—Ä—Ç–∞ -->
  <section class="fade-in">
    <p>–ú—ã –≥–æ—Ç–æ–≤–∏–º —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ª–∞–∫–æ–º—Å—Ç–≤–æ, –¥–æ–≤–µ–¥—ë–Ω–Ω–æ–µ –¥–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞ ‚Äî –æ—Ä–µ—à–∫–∏.</p>
    <p>–í –∫–∞–∂–¥–æ–º ‚Äî –±–∞–ª–∞–Ω—Å —Ö—Ä—É—Å—Ç—è—â–µ–π —Å–∫–æ—Ä–ª—É–ø–∫–∏ –∏ –Ω–µ–∂–Ω–æ–π –Ω–∞—á–∏–Ω–∫–∏.</p>
    <p>–≠—Ç–æ –¥–µ—Å–µ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ –¥–µ—Ç—Å—Ç–≤—É, –Ω–æ –≤ –Ω–æ–≤–æ–º, –∏–∑—ã—Å–∫–∞–Ω–Ω–æ–º –∑–≤—É—á–∞–Ω–∏–∏.</p>
  </section>

  <div class="divider"></div>

  <!-- –§–æ—Ä–º–∞ –∑–∞–∫–∞–∑–∞ -->
  <section id="order" class="fade-in" aria-labelledby="order-title">
    <h1 id="order-title" style="margin-bottom:.2em;">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
    <p class="muted" style="margin-bottom:1.2em;">
      –¢–æ–≤–∞—Ä: <strong>–ö–æ—Ä–æ–±–æ—á–∫–∞ –æ—Ä–µ—à–∫–æ–≤ (6 —à—Ç)</strong> ‚Äî <strong>170 ‚ÇΩ –∑–∞ –∫–æ—Ä–æ–±–∫—É</strong>
    </p>

    <div class="card" role="region" aria-label="–§–æ—Ä–º–∞ –∑–∞–∫–∞–∑–∞">
      <!-- action/ method –∑–∞–¥–∞–Ω—ã –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ JS –æ—Ç–∫–ª—é—á—ë–Ω -->
      <form id="order-form" action="https://formspree.io/f/xgvleerr" method="POST" autocomplete="on" novalidate>
        <div class="grid">
          <div class="row">
            <label for="name">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è*</label>
            <input id="name" name="name" required>
          </div>

          <div class="row">
            <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏*</label>
            <input id="phone" name="phone" inputmode="tel" required placeholder="+7 999 123-45-67" pattern="^[\\d\\+\\-\\s\\(\\)]{7,}$">
          </div>

          <div class="row">
            <label for="social">–°–æ—Ü—Å–µ—Ç–∏ (WhatsApp/Telegram)</label>
            <input id="social" name="social" placeholder="+7 999 123-45-67 –∏–ª–∏ @username">
          </div>

          <div class="row">
            <label for="qty">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–æ–±–æ—á–µ–∫*</label>
            <select id="qty" name="qty" required>
              <option value="1" selected>1 –∫–æ—Ä–æ–±–∫–∞ ‚Äî 6 —à—Ç</option>
              <option value="2">2 –∫–æ—Ä–æ–±–∫–∏ ‚Äî 12 —à—Ç</option>
              <option value="3">3 –∫–æ—Ä–æ–±–∫–∏ ‚Äî 18 —à—Ç</option>
              <option value="4">4 –∫–æ—Ä–æ–±–∫–∏ ‚Äî 24 —à—Ç</option>
              <option value="5">5 –∫–æ—Ä–æ–±–æ–∫ ‚Äî 30 —à—Ç</option>
            </select>
          </div>

          <div class="row">
            <label for="date">–ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è*</label>
            <input type="date" id="date" name="date" required>
          </div>

          <div class="row">
            <label for="time">–í—Ä–µ–º—è (–æ—Ä–∏–µ–Ω—Ç–∏—Ä)</label>
            <input type="time" id="time" name="time">
          </div>

          <div class="row">
            <label for="method">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è ( –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –º–µ–Ω—å—à–µ  15 —É–ø–∞–∫–æ–≤–æ–∫ –æ—Ä–µ—à–∫–æ–≤, —Ç–æ –¥–æ—Å—Ç–∞–≤–∫–∞ –ø–ª–∞—Ç–Ω–∞—è)</label>
            <select id="method" name="method">
              <option value="pickup" selected>–°–∞–º–æ–≤—ã–≤–æ–∑</option>
              <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞</option>
            </select>
          </div>

          <div class="row" id="address-row" style="display:none;">
            <label for="address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
            <input id="address" name="address" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –ø–æ–¥—ä–µ–∑–¥">
          </div>

          <div class="row" style="grid-column: 1 / -1;">
            <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
            <textarea id="comment" name="comment" rows="3" placeholder="–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–¥–ø–∏—Å–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç–∫—É –∏ —Ç.–¥."></textarea>
          </div>
        </div>

        <div class="summary" aria-live="polite">
          <span>–ò—Ç–æ–≥–æ: <strong id="total-text">170 ‚ÇΩ</strong></span>
          <span class="muted">170 ‚ÇΩ √ó <span id="qty-text">1</span> –∫–æ—Ä–æ–±.</span>
        </div>

        <div class="actions">
          <button id="submit-btn" type="submit" class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>

        <p id="form-status" class="note" style="display:none;"></p>
      </form>
    </div>
  </section>

  <div class="divider"></div>
  <div class="divider"></div>

  <!-- –û–¢–ó–´–í–´ -->
  <section id="reviews" class="fade-in" aria-labelledby="reviews-title">
    <h1 id="reviews-title" style="margin-bottom:.6em;">–û—Ç–∑—ã–≤—ã</h1>
    <p class="muted">–û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤ ‚Äî –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –Ω–∏–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ üëá</p>

    <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ Google -->
    <div class="card" style="margin-bottom:1em;">
      <iframe
        src="https://docs.google.com/forms/d/e/1FAIpQLSf4VRDOWWDG5MpNYRm5U85rN05rm757jVgCUM8a0x_o4M7IYA/viewform?embedded=true"
        width="100%" height="520" frameborder="0" marginheight="0" marginwidth="0">
        –ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶
      </iframe>
    </div>

    <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤ -->
    <div id="reviews-list" aria-live="polite"></div>
  </section>

  <div class="divider"></div>

  <!-- –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã -->
  <section class="fade-in" aria-labelledby="schedule-title">
    <h1 id="schedule-title" style="margin-bottom:.6em;">–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã</h1>
    <p class="muted">–° –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è –ø–æ —á–µ—Ç–≤–µ—Ä–≥ ‚Äî <strong>09:00‚Äì20:00</strong></p>
    <p class="muted">–ü—è—Ç–Ω–∏—Ü–∞ ‚Äî <strong>09:00‚Äì15:00</strong></p>
    <p class="muted">–°—É–±–±–æ—Ç–∞ ‚Äî <strong>–≤—ã—Ö–æ–¥–Ω–æ–π</strong></p>
  </section>

  <div class="divider"></div>

  <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
  <section class="fade-in" aria-labelledby="contacts-title">
    <h1 id="contacts-title" style="margin-bottom:.6em;">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
    <div class="actions" style="justify-content:center;">
      <a class="btn" href="tel:+79633883334" aria-label="–ü–æ–∑–≤–æ–Ω–∏—Ç—å –Ω–∞–º">–ù–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω</a>
      <a class="btn btn-outline" href="https://t.me/kamill_lli" target="_blank" rel="noopener" aria-label="–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—à Telegram">–ù–∞—à Telegram</a>
    </div>
  </section>

  <!-- –§—É—Ç–µ—Ä -->
  <footer class="fade-in">
    <p><strong>–ü–æ–ª–æ–≤–∏–Ω–∫–∏</strong> ‚Äî –¥–æ–º–∞—à–Ω—è—è –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è</p>
    <p>–ö–∞–∂–¥—ã–π –æ—Ä–µ—à–µ–∫ ‚Äî —ç—Ç–æ –º–æ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è</p>
  </footer>

  <!-- PapaParse –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ CSV -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    // –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è
    const faders = document.querySelectorAll('.fade-in');
    const dividers = document.querySelectorAll('.divider');
    const appearOptions = { threshold: 0.2, rootMargin: "0px 0px -50px 0px" };
    const appearOnScroll = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (!entry.isIntersecting) return;
        entry.target.classList.add("visible");
        observer.unobserve(entry.target);
      });
    }, appearOptions);
    faders.forEach(fader => appearOnScroll.observe(fader));
    dividers.forEach(divider => appearOnScroll.observe(divider));

    // ===== –õ–æ–≥–∏–∫–∞ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞ =====
    const PRICE_PER_BOX = 170; // ‚ÇΩ –∑–∞ –∫–æ—Ä–æ–±–∫—É (6 —à—Ç)
    const qtyEl = document.getElementById('qty');
    const totalTextEl = document.getElementById('total-text');
    const qtyTextEl = document.getElementById('qty-text');
    const methodEl = document.getElementById('method');
    const addressRow = document.getElementById('address-row');
    const form = document.getElementById('order-form');
    const statusEl = document.getElementById('form-status');
    const submitBtn = document.getElementById('submit-btn');

    function formatRUB(v){
      try { return new Intl.NumberFormat('ru-RU', { style:'currency', currency:'RUB', maximumFractionDigits:0 }).format(v); }
      catch { return v.toFixed(0) + ' ‚ÇΩ'; }
    }

    function updateSummary(){
      const qty = parseInt(qtyEl.value, 10) || 1;
      const total = qty * PRICE_PER_BOX;
      totalTextEl.textContent = formatRUB(total);
      qtyTextEl.textContent = String(qty);
    }

    qtyEl.addEventListener('change', updateSummary);
    updateSummary();

    methodEl.addEventListener('change', () => {
      addressRow.style.display = methodEl.value === 'delivery' ? '' : 'none';
    });

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Formspree –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const social = document.getElementById('social').value.trim();
      const qty = parseInt(qtyEl.value, 10) || 1;
      const date = document.getElementById('date').value;
      const time = document.getElementById('time').value;
      const method = methodEl.value;
      const address = (document.getElementById('address').value || '').trim();
      const comment = (document.getElementById('comment').value || '').trim();

      if(!name || !phone || !date){
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –¥–∞—Ç—É –ø–æ–ª—É—á–µ–Ω–∏—è.');
        return;
      }
      if(method === 'delivery' && !address){
        alert('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏.');
        return;
      }

      const total = qty * PRICE_PER_BOX;

      // –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è Formspree
      const payload = {
        product: '–ö–æ—Ä–æ–±–æ—á–∫–∞ –æ—Ä–µ—à–∫–æ–≤ (6 —à—Ç)',
        unit_price: PRICE_PER_BOX + ' ‚ÇΩ',
        quantity: qty,
        total: total + ' ‚ÇΩ',
        date,
        time,
        method: method === 'pickup' ? '–°–∞–º–æ–≤—ã–≤–æ–∑' : '–î–æ—Å—Ç–∞–≤–∫–∞',
        address: method === 'delivery' ? address : '',
        name,
        phone,
        social,
        comment
      };

      // UI: –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
      submitBtn.disabled = true;
      submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';
      statusEl.style.display = 'block';
      statusEl.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑...';

      try {
        const resp = await fetch('https://formspree.io/f/xgvleerr', {
          method: 'POST',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload)
        });

        if (resp.ok) {
          // –£—Å–ø–µ—Ö: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ä–∞—Å–∏–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —á–∏—Å—Ç–∏–º —Ñ–æ—Ä–º—É
          form.reset();
          updateSummary();
          addressRow.style.display = 'none';
          statusEl.innerHTML = '–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑! –ú—ã —Å –≤–∞–º–∏ —Å–≤—è–∂–µ–º—Å—è —á–µ—Ä–µ–∑ –≤–∞—à–∏ —Å–æ—Ü—Å–µ—Ç–∏ –∏–ª–∏ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞ –∏–ª–∏ –¥–ª—è –µ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.';
        } else {
          statusEl.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É/–≤ Telegram.';
        }
      } catch (err) {
        console.error(err);
        statusEl.textContent = '–°–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑';
      }
    });

    /* ===== –û–¢–ó–´–í–´: –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Google Sheets (CSV) ===== */
    const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQzuRGHZ_li9ttKlasMPdelaWnWY3mondMMNGW0o9pGwtsVJC5zMDsQ-WL6vq1z4RTK0SrE5fAzltBU/pub?output=csv';
    const reviewsListEl = document.getElementById('reviews-list');

    function escapeHTML(s){
      return String(s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
    }

    function renderReviews(rows){
      reviewsListEl.innerHTML = '';
      if(!rows.length){
        reviewsListEl.innerHTML = '<p class="muted">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤ ‚Äî –±—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>';
        return;
      }
      rows.forEach(r => {
        // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ (RU/EN)
        const name = escapeHTML(r['–í–∞—à–µ –∏–º—è'] || r['name'] || '–ì–æ—Å—Ç—å');
        const text = escapeHTML(r['–í–∞—à –æ—Ç–∑—ã–≤'] || r['text'] || '');
        const status = String(r['status'] || 'published').toLowerCase();
        if(status && status !== 'published') return;

        const tsRaw = r['–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏'] || r['Timestamp'] || '';
        const dstr = tsRaw ? new Date(tsRaw).toLocaleString('ru-RU', {
          day:'2-digit', month:'2-digit', year:'numeric', hour:'2-digit', minute:'2-digit'
        }) : '';

        const card = document.createElement('div');
        card.className = 'card';
        card.style.marginBottom = '10px';
        card.innerHTML = `
          <div style="display:flex;justify-content:space-between;gap:12px;align-items:baseline;">
            <strong style="font-size:1.05rem">${name}</strong>
            <span class="muted" style="white-space:nowrap">${escapeHTML(dstr)}</span>
          </div>
          <div style="margin-top:.4em; font-size:1rem; white-space:pre-wrap;">${text}</div>
        `;
        reviewsListEl.appendChild(card);
      });
    }

    async function loadReviews(){
      try{
        const url = SHEET_CSV_URL + (SHEET_CSV_URL.includes('?') ? '&' : '?') + '_=' + Date.now();
        const res = await fetch(url, { mode:'cors', cache:'no-store' });
        const csv = await res.text();
        Papa.parse(csv, {
          header: true,
          skipEmptyLines: true,
          complete: (result) => {
            const rows = (result.data || []).map(r => {
              const ts = r['–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏'] || r['Timestamp'] || '';
              return { ...r, _ts: ts ? new Date(ts).getTime() : 0 };
            }).sort((a,b) => b._ts - a._ts);
            renderReviews(rows);
          }
        });
      }catch(e){
        console.error(e);
        reviewsListEl.innerHTML = '<p class="muted">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ç–∑—ã–≤—ã. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.</p>';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadReviews();
      // –ú–æ–∂–Ω–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø–∏—Å–æ–∫:
      // setInterval(loadReviews, 30000);
    });
  </script>

</body>
</html>
